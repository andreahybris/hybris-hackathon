# <a id="Hybris_Profile_Hackathons__Sep_2016_0"></a>Hybris Profile Hackathons - Sep 2016

SAP Hybris Profile allows businesses to create, maintain, and continually extend customer profiles from a range of data sources. A profile is a collection of attributes, conclusions, and classifications about a customer derived from customer interactions with the company. A customer profile can include:

*   Commerce-related data
*   Product, Category, and Brand affinities
*   Purchase history
*   Browsing history and behavior, including basic behavioral attributes
*   Technical attributes and classifications, such as device and browser-specific attributes

The SAP Hybris Profile platform leverages a graph database that allows dynamic extension of the data domain without explicitly redefining the structure of the database. Consuming applications benefit from rich, contextually consistent and relevant representations of customers that evolve over time.

# <a id="Prerequisites_11"></a>Prerequisites

1.  [Sign up to YaaS](https://www.yaas.io/register/)

2.  Create an organization, specifying _Non-commercial_.

3.  Create a Project:

    *   In the left-hand navigation column, select **Administration**
    *   In the left-hand navigation column, select **Projects**
    *   Click **+PROJECT**
    *   Follow the project-creation wizard
4.  To allow you to subscribe to free _SAP Hybris Profile_ beta packages, provide on-site Hybris Staff with your <TENANT> value in order to whitelist your project. Access your <tenant>value as follows:</tenant>

    *   Navigate to your project page
    *   In the left-hand navigation column, click **Administration**.
    *   Copy the value of the _Identifier_ field. This is your <TENANT> value.
5.  Once your project has been whitelisted, subscribe to public _commerce packages_:

    *   Navigate to your project page
    *   In the left-hand navigation column, click **Administration** and then **Subscription**.
    *   Click the **+SUBSCRIPTION** link and then subscribe to each of the following public _commerce packages_.
        *   Cart
        *   Checkout
        *   Coupon Management
        *   Customer Accounts
        *   Media
        *   Order Management
        *   Product Content
        *   Site Management

    **NOTE: You can read about each commerce package [here](https://devportal.yaas.io/tools/commerceasaserviceguide/index.html#CommercePackages).**

6.  Subscribe to private _Hybris Profile packages_:

    *   Navigate to your project page
    *   In the left-hand navigation column, click **Administration** and then **Subscription**.
    *   Subscribe to each of the following _private packages_ by clicking the **+PRIVATE PACKAGE** link for each package and entering the associated Version ID:
        *   Profile Core Service Package: Version ID _579732baca4e04001dae50bb_
        *   Profile Services for Commerce Package Version: Version ID _5799b698ca4e04001dae5cfb_

    **NOTE: There may be a delay before your packages are listed in the Subscriptions section; refresh your browser to reload the listing.**

7.  Create a client within your project:

    *   Navigate to your project page
    *   Click **Clients** in the left-hand navigation column
    *   Click **+ CLIENT** to create a client
    *   On the **Required Scopes** page, click _Select All_ to choose all scopes (permissions)
    *   Click **NEXT** in the upper-right corner to complete the client-creation wizard
    *   Copy the _Identifier_ value as your <CLIENT_IDENTIFIER>
    *   In the **Client Authorization** section on your client page:
        *   Click **SHOW** and copy the _Client ID_ value as your <CLIENT_ID>, and copy the _Client Secret_ value as your <CLIENT_SECRET>
8.  Run scripts to ingest data into your system.

    *   [Install Groovy](http://groovy-lang.org/install.html) on your machine

    *   On a command line, enter the hybris_hackathon/commerce-import directory that was extracted from your flash drive

    *   Ingest a working data set: **_import_** product, customer, and category data into your YaaS project; then **_populate_** the graph with this new project data.
        You can choose to work with a small data set and/or a large data set. The small data set will **_import_** quickly; the large data set may take up to an hour to **_import_**.

        NOTE that you can, if desired:

        1.  **_Import_** and **_populate_** the small data set
        2.  **_Import_** the large data set and _work with the small data set while waiting for this command to complete_
        3.  Once #2 is complete, **_populate_** the graph with the large data set and start working with itThe **_import_** command: use '-f sampledata/hackathon_small' to import the small data set; use '-f sampledata/hackathon' to import the large data set

        `groovy yimport.groovy -p <TENANT> -f [sampledata/hackathon_small OR sampledata/hackathon] -id <CLIENT_ID> -secret <CLIENT SECRET> -clientIdentifier <CLIENT_IDENTIFIER>`

        The **_populate_** command

        `groovy EdgeImport.groovy -p <TENANT> -id <CLIENT_ID> -secret <CLIENT_SECRET> -baseurl https://api.yaas.io`

9.  Set up a [fully-functional online storefront](https://devportal.yaas.io/gettingstarted/setupastorefront/index.html). This storefront will also submit data to the SAP Hybris Profile system including: user identities, login events, page views, keyword searches, category views, product views, shopping cart events. Configure your storefront to send data to the SAP Hybris Profile system. Add the following code snippet before the closing </body> tag of the storefront index.html file:

    `<script async defer src="js/vendor-static/piwik.js"></script><div ytracking></div>`

# <a id="Lets_hack_81"></a>Let’s hack…

**NOTE: Links to documentation for services referenced in these instructions can be found [here](https://devportal.yaas.io/services).**

In order to access SAP Hybris APIs, you need to **obtain a token** that can be used for all subsequent API calls. Execute the following command to obtain a token:

```
curl -X POST -H "Content-Type: application/x-www-form-urlencoded" -d 'grant_type=client_credentials&scope=hybris.org_project_manage%20hybris.account_manage%20hybris.account_view%20hybris.org_members%20sap.subscription_provider_view%20hybris.profile_consent_manage%20hybris.profile_consent_view%20hybris.profile_metamodel_manage%20hybris.profile_metamodel_view%20hybris.profile_tracking_manage%20hybris.profile_graph_manage%20hybris.profile_graph_view%20hybris.profile_context_manage%20hybris.profile_context_view%20hybris.tenant=<TENANT>&client_id=<CLIENT_ID>&client_secret=<CLIENT_SECRET>' "https://api.yaas.io/hybris/oauth2/v1/token"

```

The value of the returned _access_token_ attribute will have a form similar to this string: _012-3abc45d6-7890-1e23-fg45-6h7ijkl890m1_. In subsequent instructions, this _access_token_ value will be referenced as `<ACCESS_TOKEN>`.

## <a id="Hello_Graph_93"></a>“Hello, Graph!”

This section guides you in writing a node to, and then reading the node from, the SAP Hybris Profile graph. The Secure Graph Service, documented [here](https://devportal.yaas.io/services/securegraph/latest/index.html), provides more endpoints for writing to and reading from the graph.

1.  Fetch all metadata for your tenant to verify schemas:

    `curl -X GET -H "Content-Type: application/json" -H "Authorization: Bearer <ACCESS_TOKEN>" "https://api.yaas.io/hybris/profile-enr-auth/v1/tenants/<TENANT>/schemas"`

2.  Execute a PUT command to write a Product node, using previously-registered _nodes/commerce/Product_ schema:

    `curl -X PUT -H "Content-Type: application/json" -H "Authorization: Bearer <ACCESS_TOKEN>" -H "consent-reference: dummy" -d '{ "name" : "Hello, Graph!", "description": "A simple example." }' "https://api.yaas.io/hybris/profile-secured-graph/v1/<TENANT>/nodes/commerce/Product/<PRODUCT_ID>" -i`

3.  Execute a GET command to read the list of products:

    `curl -X GET -H "Content-Type: application/json" -H "Authorization: Bearer <ACCESS_TOKEN>" "https://api.yaas.io/hybris/product/v1/<TENANT>/products"`

4.  Execute a GET command to read the Product node from the graph. Use one of the <PRODUCT_ID>s from the results of the previous command

    `curl -X GET -H "Content-Type: application/json" -H "Authorization: Bearer <ACCESS_TOKEN>" "https://api.yaas.io/hybris/profile-secured-graph/v1/<TENANT>/nodes/commerce/Product/<PRODUCT_ID>"`

5.  Execute a GET command to return the neighbors of a specific Node:

    `curl -X GET -H "Content-Type: application/json" -H "Authorization: Bearer <ACCESS_TOKEN>" "https://api.yaas.io/hybris/profile-secured-graph/v1/<TENANT>/neighbours/commerce/Product/<PRODUCT_ID>`

For more in-depth information, please see our [Hybris Profile Solutions](https://devportal.yaas.io/solutions/saphybrisprofile/index.html) page.
